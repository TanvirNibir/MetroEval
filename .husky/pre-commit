#!/bin/sh
# Pre-commit hook to automatically run tests
. "$(dirname "$0")/_/husky.sh"

echo "üß™ Running tests before commit..."

# Run frontend tests
cd frontend
npm test -- --run
FRONTEND_EXIT_CODE=$?

if [ $FRONTEND_EXIT_CODE -ne 0 ]; then
  echo "‚ùå Frontend tests failed. Please fix before committing."
  exit 1
fi

cd ..

# Run backend tests if pytest is available
if command -v pytest &> /dev/null; then
  cd backend
  pytest tests/ -v --tb=short
  BACKEND_EXIT_CODE=$?
  cd ..
  
  if [ $BACKEND_EXIT_CODE -ne 0 ]; then
    echo "‚ùå Backend tests failed. Please fix before committing."
    exit 1
  fi
fi

echo "‚úÖ All tests passed! Proceeding with commit."

