# Exported from Render on 2025-11-30T11:47:45Z
# Updated with fixes for build command and frontend service

version: "1"

services:
  # Backend Service
  - type: web
    name: MetroEval
    runtime: python
    repo: https://github.com/TanvirNibir/MetroEval
    plan: free
    region: frankfurt
    rootDir: .
    buildCommand: pip install --upgrade pip && pip install Flask==3.0.0 mongoengine==0.27.0 pymongo==4.6.0 Flask-Login==0.6.3 Flask-Limiter==3.5.0 Flask-WTF==1.2.1 Flask-Talisman==1.1.0 Werkzeug==3.0.1 "google-generativeai>=0.3.0" scikit-learn==1.3.2 numpy==1.24.3 pandas==2.1.3 python-dotenv==1.0.0 sentence-transformers==2.2.2 nltk==3.8.1 bleach==6.1.0 "urllib3<2.0" gunicorn
    startCommand: gunicorn --bind 0.0.0.0:$PORT --workers 4 --timeout 120 --access-logfile - --error-logfile - backend.app.wsgi:app
    autoDeployTrigger: commit
    envVars:
      - key: PYTHON_VERSION
        value: 3.11.0
      - key: PYTHONUNBUFFERED
        value: 1
      - key: PYTHONPATH
        value: /opt/render/project/src
      - key: FLASK_ENV
        value: production
      - key: SECRET_KEY
        sync: false
      - key: MONGODB_URI
        sync: false
      - key: GOOGLE_API_KEY
        sync: false
      - key: CORS_ALLOWED_ORIGINS
        sync: false

  # Frontend Service
  - type: web
    name: MetroEval-Frontend
    runtime: docker
    repo: https://github.com/TanvirNibir/MetroEval
    plan: free
    region: frankfurt
    dockerfilePath: ./Dockerfile.frontend
    dockerContext: .
    autoDeployTrigger: commit
    envVars:
      - key: REACT_APP_API_URL
        sync: false
      - key: RENDER_SERVICE_NAME
        value: MetroEval
